<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
  <title>Ghada Tourism</title>
  <base target="_top">
  <? var appUrl = getUrl(); var url = appUrl; ?>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">

  <?!= include("29lt_bukrabold"); ?>
  <?!= include("style"); ?>

</head>


<body dir="rtl" data-page="edit-reservation">
  <?!= include("shared-header"); ?>

  <div class="container-lg px-0" id="content">
    <div>
      <form id="registration-form">
        <div class="form-group mb-3 bg-white">
          <div id="formdiv" class="mx-0">
            <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨Ø§Ø¦Ø¹ -->
            <div class="row pt-4">
              <div class="col-md-12">
                <h1 class="text-center fw-bold" style="color: rgb(0,136,145);font-size: 20px;line-height: 50px;">
                  <strong><span style="background-color: rgb(255, 255, 255);">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨Ø§Ø¦Ø¹</span></strong>
                </h1>
              </div>
            </div>

            <div class="row mx-0 px-2 py-3">
              <div class="col-12 col-md-9 mx-auto">
                <p class="mb-2"><strong>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø¦Ø¹</strong></p>
                <select class="form-select mb-4" name="seller" id="sellerSelect" required></select>

                <p class="mb-2"><strong>Ø§Ù„Ù…ÙˆØ±Ø¯</strong></p>
                <select class="form-select mb-4" name="supplier" id="supplierSelect" required></select>
              </div>
            </div>
            <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ -->
            <div class="row pt-4">
              <div class="col-md-12">
                <h1 class="text-center fw-bold" style="color: rgb(0,136,145);font-size: 20px;line-height: 50px;">
                  <strong><span>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</span></strong>
                </h1>
              </div>
            </div>

            <div class="row mx-0 px-2 py-3">
              <div class="col-12 col-md-9 mx-auto">
                <p class="mb-2"><strong>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</strong></p>
                <input class="form-control mb-4" type="text" name="name" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">

                <p class="mb-2"><strong>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</strong></p>
                <input class="form-control mb-4" type="text" name="phone" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">

                <p class="mb-2"><strong>Ø§Ù„Ø¬Ù†Ø³ÙŠØ©</strong></p>
                <select class="form-select mb-4" name="nationality" id="nationalitySelect" required></select>

                <p class="mb-2"><strong>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ø®Ø§Øµ</strong></p>
                <select class="form-select mb-4" name="personCount" id="personSelect" required></select>
              </div>
            </div>

            <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙÙ†Ø¯Ù‚ -->
            <div class="row pt-4">
              <div class="col-md-12">
                <h1 class="text-center fw-bold" style="color: rgb(0,136,145);font-size: 20px;line-height: 50px;">
                  <strong><span>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙÙ†Ø¯Ù‚</span></strong>
                </h1>
              </div>
            </div>

            <div class="row mx-0 px-2 py-3">
              <div class="col-12 col-md-9 mx-auto gy-3">
                <p class="mb-2"><strong>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</strong></p>
                <select class="form-select mb-4" name="city" id="citySelect" onchange="onCityChange()"
                  required></select>

                <p class="mb-2"><strong>Ø§Ù„ÙÙ†Ø¯Ù‚</strong></p>
                <select class="form-select mb-4" name="hotel" id="hotelSelect" required></select>

                <p class="mb-2"><strong>Ø§ÙŠØ¯ÙŠ ØªØ£ÙƒÙŠØ¯ Ø­Ø¬Ø² Ø§Ù„ÙÙ†Ø¯Ù‚</strong></p>
                <input class="form-control mb-4" name="HotelConformation" type="text" required placeholder="Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²" inputmode="decimal"/>

                <p class="mb-2"><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„ÙˆØµÙˆÙ„</strong></p>
                <input class="form-control mb-4" type="date" name="chekInDate">

                <p class="mb-2"><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©</strong></p>
                <input class="form-control mb-4" type="date" name="chekOutDate">

                <p class="mb-2"><strong>Ø¹Ø¯Ø¯ Ø§Ù„ØºØ±Ù</strong></p>
                <select class="form-select mb-4" name="roomCount" id="numberSelect" required></select>

                <p class="mb-2"><strong>Ù†ÙˆØ¹ Ø§Ù„ØºØ±ÙØ©</strong></p>
                <select class="form-select mb-4" name="roomType" id="roomSelect" required></select>

                <p class="mb-2"><strong>Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø·Ù„Ø§Ù„Ø©</strong></p>
                <select class="form-select mb-4" name="viewType" id="viewSelect" required></select>

                <p class="mb-2"><strong>Ø§Ù„ÙˆØ¬Ø¨Ø§Øª</strong></p>
                <select class="form-select mb-4" name="meal" id="mealSelect" required></select>
              </div>
            </div>



            <!-- Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© -->
            <div class="row pt-4">
              <div class="col-md-12">
                <h1 class="text-center fw-bold" style="color: rgb(0,136,145);font-size: 20px;line-height: 50px;">
                  <strong><span>Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©</span></strong>
                </h1>
              </div>
            </div>

            <div class="row mx-0 px-2 py-3">
              <div class="col-12 col-md-9 mx-auto">
                <p class="mb-2"><strong>Ø³Ø¹Ø± Ø§Ù„ÙÙ†Ø¯Ù‚</strong></p>
                <input class="form-control mb-4" name="hotelPrice" type="text" required placeholder="Ø³Ø¹Ø± Ø§Ù„ÙÙ†Ø¯Ù‚"
                  inputmode="decimal">
                <input class="form-control mb-4" name="hotelEuroPrice" type="text" required
                  placeholder="Ø³Ø¹Ø± Ø§Ù„ÙÙ†Ø¯Ù‚ Ø¨Ø§Ù„ÙŠÙˆØ±Ùˆ â‚¬" inputmode="decimal">

                <p class="mb-2"><strong>Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹</strong></p>
                <input class="form-control mb-4" name="sellingPrice" type="text" required placeholder="Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹"
                  inputmode="decimal">
                <input class="form-control mb-4" name="sellingEuroPrice" type="text" required
                  placeholder="Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹ Ø¨Ø§Ù„ÙŠÙˆØ±Ùˆ â‚¬" inputmode="decimal">

                <p class="mb-2"><strong>Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„Ø©</strong></p>
                <select class="form-select mb-4" name="hotelCurrency" id="currencySelect1" required></select>

                <p class="mb-2"><strong>Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</strong></p>
                <select class="form-select mb-4" name="kdv" id="kdvSelect" required></select>

                <p class="mb-2"><strong>Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ÙÙ†Ø¯Ù‚</strong></p>
                <input class="form-control mb-4" name="hotelComm" type="text" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ÙÙ†Ø¯Ù‚"
                  inputmode="decimal">

                <p class="mb-2"><strong>Ù†Ø³Ø¨Ø© Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ÙÙ†Ø¯Ù‚ %</strong></p>
                <input class="form-control mb-4" name="hotelCommPrc" type="text" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ÙÙ†Ø¯Ù‚ %"
                  inputmode="decimal">

                <p class="mb-2"><strong>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø³Ù„</strong></p>
                <input class="form-control mb-4" name="amountSent" required type="text" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø³Ù„"
                  inputmode="decimal">
                <input class="form-control mb-4" name="amountEuroSent" required type="text"
                  placeholder="Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø³Ù„ Ø¨Ø§Ù„ÙŠÙˆØ±Ùˆ â‚¬" inputmode="decimal">

                  
                <p class="mb-2"><strong>Ø·Ø±ÙŠÙ‚Ø© Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†</strong></p>
                <select class="form-select mb-4" name="ra3bon" id="ra3bonSelect" required></select>

                <p class="mb-2"><strong>ØªÙƒØ§Ù„ÙŠÙ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</strong></p>
                <input class="form-control mb-4" name="arrivedAmount" type="text" placeholder="ØªÙƒØ§Ù„ÙŠÙ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„"
                  inputmode="decimal">
                <input class="form-control mb-4" name="arrivedEuroAmount" type="text"
                  placeholder="ØªÙƒØ§Ù„ÙŠÙ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø§Ù„ÙŠÙˆØ±Ùˆ â‚¬" inputmode="decimal">

                <p class="mb-2"><strong>Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„Ø©</strong></p>
                <select class="form-select mb-4" name="amountSentCurrency" id="currencySelect2" required></select>

                <p class="mb-2"><strong>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</strong></p>
                <input class="form-control mb-4" name="remainingAmount" type="text" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ"
                  inputmode="decimal">
                <input class="form-control mb-4" name="remainingEuroAmount" type="text"
                  placeholder="Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø¨Ø§Ù„ÙŠÙˆØ±Ùˆ â‚¬" inputmode="decimal">

                <p class="mb-2"><strong>Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„Ø©</strong></p>
                <select class="form-select mb-4" name="amountRemainingCurrency" id="currencySelect3" required></select>

                <p class="mb-2"><strong>Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø¬Ø²</strong></p>
                <select class="form-select mb-4" name="reservationState" id="reservationSelect" required></select>

                <p class="mb-2"><strong>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªØ­ØµÙŠÙ„</strong></p>
                <select class="form-select mb-4" name="collectionMethod" id="collectionSelect" required></select>

                <p class="mb-2"><strong>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</strong></p>
                <textarea class="form-control mb-4" style="font-size:14px;" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ Ù‡Ù†Ø§"
                  name="note"></textarea>

              </div>
            </div>
            <!-- Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© -->
            <div class="row pt-4">
              <div class="col-md-12">
                <h1 class="text-center fw-bold" style="color: rgb(0,136,145);font-size: 20px;line-height: 50px;">
                  <strong><span>Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©</span></strong>
                </h1>
              </div>
            </div>
            <div class="row mx-0 px-2 py-3">
              <div class="col-12 col-md-9 mx-auto">

                <p class="mb-2"><strong>Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©</strong></p>
                <select class="form-select mb-4" name="service" id="serviceSelect"></select>

                <p class="mb-2"><strong>Ø³Ø¹Ø± Ø§Ù„Ø®Ø¯Ù…Ø©</strong></p>
                <input class="form-control mb-4" name="servicePrice" type="text" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø®Ø¯Ù…Ø© Ø¹Ù„ÙŠÙ†Ø§"
                  inputmode="decimal">
                <input class="form-control mb-4" name="serviceEuroPrice" type="text"
                  placeholder="â‚¬ Ø³Ø¹Ø± Ø§Ù„Ø®Ø¯Ù…Ø© Ø¹Ù„ÙŠÙ†Ø§ Ø¨Ø§Ù„ÙŠÙˆØ±Ùˆ" inputmode="decimal">
                <input class="form-control mb-4" name="serviceRemainingPrice" type="text" placeholder="Ø³Ø¹Ø± Ù…Ø¨ÙŠØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©"
                  inputmode="decimal">
                <input class="form-control mb-4" name="serviceRemainingEuroPrice" type="text"
                  placeholder="â‚¬ Ø³Ø¹Ø± Ù…Ø¨ÙŠØ¹ Ø§Ù„Ø®Ø¯Ù…Ø© Ø¨Ø§Ù„ÙŠÙˆØ±Ùˆ" inputmode="decimal">

                <p class="mb-2"><strong>Ù‡Ø¯ÙŠØ© Ø§Ù„ÙˆØ±ÙˆØ¯</strong></p>
                <select class="form-select mb-4" name="freeFlower" id="flowerSelect"></select>

              </div>
            </div>


            <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙˆØ³ÙŠØ· -->
            <div class="row pt-4">
              <div class="col-md-12">
                <h1 class="text-center fw-bold" style="color: rgb(0,136,145);font-size: 20px;line-height: 50px;">
                  <strong><span>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙˆØ³ÙŠØ·</span></strong>
                </h1>
              </div>
            </div>
            <div class="row mx-0 px-2 py-3">
              <div class="col-12 col-md-9 mx-auto">

                <p class="mb-2"><strong>Ø§Ø³Ù… Ø§Ù„ÙˆØ³ÙŠØ·</strong></p>
                <select class="form-select mb-4" name="mediator" id="mediatorSelect"></select>

                <p class="mb-2"><strong>Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©</strong></p>
                <input class="form-control mb-4" name="commission" type="text" placeholder="Ø£Ø¯Ø®Ù„ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©"
                  inputmode="decimal">

              </div>
            </div>
            <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
            <div class="row d-flex justify-content-center" style="margin-right:0px;margin-left:0px;padding-top:24px;">
              <div class="col col-5 text-start">
                <button class="btn btn-danger btn-lg" id="reset" type="reset">Ù…Ø³Ø­</button>
              </div>
              <div class="col col-5 text-end">
                <button class="btn btn-primary btn-lg" id="submit" type="submit">ØªØ¹Ø¯ÙŠÙ„</button>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
  <input type="hidden" value="<?= url ?>" id="url" />

  <!-- Ù…Ø­ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª -->
  <div id="oanda_ecc">
    <div id="floatingButtonContainer">
      <button id="toggleWidgetButton">ğŸ’±</button>
      <div id="floatingWidgetPanel">
        <script>
          var fm = "SAR";
          var to = "EUR";
          var tz = "3";
          var sz = "1x1";
          var lg = "ar";
          var st = "success";
          var lr = "1";
          var rd = "0";
        </script>
        <script src="//currencyrate.today/converter"></script>
        <div style="text-align:right">
          <a href="https://currencyrate.today">Ù…Ø­ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª</a>
        </div>
      </div>
    </div>
  </div>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');

    body {
      font-family: 'Cairo', sans-serif;
      direction: rtl;
    }

    .form-control,
    .form-select {
      text-align: right;
    }

    .btn {
      font-family: 'Cairo', sans-serif;
    }

    p {
      font-family: 'Cairo', sans-serif;
      font-size: 18px;
      color: rgb(44 63 63);
    }

    .navbar-nav {
      padding-right: 0;
    }

    .offset-md-1 {
      margin-right: 8.33333%;
      margin-left: 0;
    }
  </style>
</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script>
    const selectList = [
      { selectId: 'sellerSelect', columnName: 'SELLERS', placeholder: 'Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø¦Ø¹' },
      { selectId: 'supplierSelect', columnName: 'HOTEL SUPPLIER', placeholder: 'Ø§Ù„Ù…Ø²ÙˆØ¯' },
      { selectId: 'nationalitySelect', columnName: 'NATIONALITY', placeholder: 'Ø¬Ù†Ø³ÙŠØ© Ø§Ù„Ø¹Ù…ÙŠÙ„' },
      { selectId: 'personSelect', columnName: 'PERSONS', placeholder: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø´Ø®Ø§Øµ' },
      { selectId: 'roomSelect', columnName: 'ROOM TYPE', placeholder: 'Ù†ÙˆØ¹ Ø§Ù„ØºØ±ÙØ©' },
      { selectId: 'viewSelect', columnName: 'VIEW TYPE', placeholder: 'Ø§Ù„Ø§Ø·Ù„Ø§Ù„Ø©' },
      { selectId: 'mealSelect', columnName: 'MEALS', placeholder: 'Ù†ÙˆØ¹ Ø§Ù„ÙˆØ¬Ø¨Ø§Øª' },
      { selectId: "ra3bonSelect", columnName: "RA3BON", placeholder: "Ø·Ø±ÙŠÙ‚Ø© ØªØ­ØµÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†"},
      { selectId: 'currencySelect1', columnName: 'CURRENCY TYPE', placeholder: 'Ø§Ù„Ø¹Ù…Ù„Ø©' },
      { selectId: 'currencySelect2', columnName: 'CURRENCY TYPE', placeholder: 'Ø§Ù„Ø¹Ù…Ù„Ø©' },
      { selectId: 'currencySelect3', columnName: 'CURRENCY TYPE', placeholder: 'Ø§Ù„Ø¹Ù…Ù„Ø©' },
      { selectId: 'flowerSelect', columnName: 'FLOWER', placeholder: 'Ù‡Ù„ ØªÙ… Ø§Ø¹Ø·Ø§Ø¡ Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ±ÙˆØ¯ØŸ' },
      { selectId: 'kdvSelect', columnName: 'KDV', placeholder: 'Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©' },
      { selectId: 'reservationSelect', columnName: 'RESERVATION STATE', placeholder: 'Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø¬Ø²' },
      { selectId: 'collectionSelect', columnName: 'COLLECTION METHOD', placeholder: 'Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªØ­ØµÙŠÙ„' },
      { selectId: 'mediatorSelect', columnName: 'MEDIATOR', placeholder: 'Ø§Ø³Ù… Ø§Ù„ÙˆØ³ÙŠØ·' },
      { selectId: 'serviceSelect', columnName: 'SERVICE', placeholder: 'Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø©' },

    ];

document.getElementById("reset").addEventListener("click", async function () {
    // Wait for all columns to clear
    await Promise.all(selectList.map(({ selectId, columnName, placeholder }) =>
        clearColumn(selectId, columnName, placeholder)
    ));

    await onCityChange();
    await getColumns();
    document.getElementById('citySelect').value = '';
});

document.getElementById("toggleWidgetButton").addEventListener("click", function () {
    const widgetPanel = document.getElementById("floatingWidgetPanel");
    widgetPanel.style.display = (widgetPanel.style.display === "none" || widgetPanel.style.display === "") ? "block" : "none";
});

// Close widget when clicking outside
document.addEventListener("click", function (event) {
    const widgetPanel = document.getElementById("floatingWidgetPanel");
    const toggleButton = document.getElementById("toggleWidgetButton");

    if (!widgetPanel.contains(event.target) && !toggleButton.contains(event.target)) {
        widgetPanel.style.display = "none";
    }
});

async function populateCities() {
    return new Promise((resolve, reject) => {
        google.script.run.withSuccessHandler((cities) => {
            console.log("Cities received:", cities);
            const citySelect = document.getElementById('citySelect');
            citySelect.innerHTML = '';

            // Placeholder
            const placeholderOption = document.createElement('option');
            placeholderOption.value = '';
            placeholderOption.textContent = 'Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©';
            placeholderOption.disabled = true;
            placeholderOption.selected = true;
            citySelect.appendChild(placeholderOption);

            cities.forEach(city => {
                const option = document.createElement('option');
                option.value = city;
                option.textContent = city;
                citySelect.appendChild(option);
            });

            resolve(); // Resolve after completion
        }).withFailureHandler(reject).getCities();
    });
}

function clearColumn(selectId, columnName, placeholder) {
    const selectElement = document.getElementById(selectId);
    selectElement.innerHTML = ""; 

    const placeholderOption = document.createElement("option");
    placeholderOption.value = "";
    placeholderOption.textContent = placeholder;
    placeholderOption.disabled = true;
    placeholderOption.selected = true;
    selectElement.appendChild(placeholderOption);
}

async function getColumns() {
    await populateCities();
    generateRoomCount();

    await Promise.all(selectList.map(({ selectId, columnName, placeholder }) =>
        getColumn(selectId, columnName, placeholder)
    ));
}

async function getColumn(selectId, columnName, placeholder) {
    try {
        const column = await new Promise((resolve, reject) => {
            google.script.run.withSuccessHandler(resolve).withFailureHandler(reject).getColumnByName(columnName);
        });

        console.log(`${columnName} received:`, column);
        const selectElement = document.getElementById(selectId);
        selectElement.innerHTML = '';

        const placeholderOption = document.createElement('option');
        placeholderOption.value = '';
        placeholderOption.textContent = placeholder;
        placeholderOption.disabled = true;
        placeholderOption.selected = true;
        selectElement.appendChild(placeholderOption);

        column.forEach(item => {
            const option = document.createElement('option');
            option.value = item;
            option.textContent = item;
            selectElement.appendChild(option);
        });

    } catch (error) {
        console.error(`Error fetching data for ${columnName}:`, error);
    }
}

async function onCityChange() {
    const city = document.getElementById('citySelect').value;
    console.log("Selected City:", city);

    return new Promise((resolve, reject) => {
        google.script.run
            .withSuccessHandler((hotels) => {
                updateHotelDropdown(hotels);
                resolve(hotels); // Now the promise resolves with the hotel list
            })
            .withFailureHandler(reject)
            .getHotelsByCity(city);
    });
}


function generateRoomCount() {
    const select = document.getElementById('numberSelect');
    select.innerHTML = ''; 

    for (let i = 1; i <= 30; i++) {
        const option = document.createElement('option');
        option.value = i;
        option.textContent = i;
        select.appendChild(option);
    }
}

function updateHotelDropdown(hotels) {
    const hotelSelect = document.getElementById('hotelSelect');
    hotelSelect.innerHTML = '';

    if (hotels && hotels.length) {
        console.log("Hotels received:", hotels);
        hotels.forEach(hotel => {
            const option = document.createElement('option');
            option.value = hotel;
            option.textContent = hotel;
            hotelSelect.appendChild(option);
        });
    } else {
        console.log("No hotels available");
        const option = document.createElement('option');
        option.value = '';
        option.textContent = 'ÙŠØ±Ø­Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§ÙˆÙ„Ø§';
        hotelSelect.appendChild(option);
    }
}

window.onload = async function () {
    var customerId = "<?= customerId ?>";
    console.log("Customer ID:", customerId);
    console.log("Your email is: " + "<?= userEmail ?>");

    await getColumns();
    await new Promise((resolve, reject) => {
        google.script.run.withSuccessHandler(populateFormFields).withFailureHandler(reject).getCustomerDataById(customerId);
    });
};

async function populateFormFields(data) {
    const form = document.getElementById('registration-form');
    const formFields = form.elements;
    console.log("---------------------------------");
    console.log("Data From Sheet:", data);
    console.log("Data From Form:", formFields);

    data.slice(1).forEach((value, index) => {
        const field = formFields[index];
        if (field) {
            field.value = value;
        }
    });

    await onCityChange();
    console.log("---------------------------------");
    formFields[7].value = data[8];
    console.log("Setting hotelSelect to:", data[8]);
}

document.getElementById("registration-form").addEventListener("submit", async function (event) {
    event.preventDefault();
    console.log('Form submitted');

    const form = document.getElementById("registration-form");
    const formData = new FormData(form);

    // Extract values based on actual form field order
    const orderedValues = Array.from(form.elements)
        .filter(el => el.name) // Ensure only named fields are included
        .map(el => formData.get(el.name));

    console.log("Ordered values:", orderedValues);

    await new Promise((resolve, reject) => {
        google.script.run
            .withSuccessHandler(() => {
                Swal.fire({
                    title: "ØªÙ…",
                    text: "ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­",
                    icon: "success",
                    heightAuto: false,
                    showConfirmButton: false,
                    timer: 1500,
                });

                setTimeout(() => {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }, 2000);

                form.reset();
                document.getElementById('citySelect').value = '';
                onCityChange();
                getColumns();

                resolve();
            })
            .withFailureHandler(reject)
            .editReservation(orderedValues, "<?= userEmail ?>", "<?= customerId ?>");
    });
});



  function navigateTo(pageName) {

    var url = document.getElementById("url").value;
    var link = document.createElement('a');
    link.href = url + "?page=" + pageName;
    link.id = 'linkURL';
    document.body.appendChild(link);
    document.getElementById("linkURL").click();

  }

</script>

</html>
